(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad82d4e8"],{"96c1":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"box_content"}},[i("div",{staticClass:"main_box"},[i("div",{staticClass:"addmark_title text_333 f_30 bg_white mb_20"},[i("div",{staticClass:"mark_cell"},[i("span",[e._v("运输任务单")]),i("div",[e._v(e._s(e.info.shipMentNo))])])]),i("div",{staticClass:"addmark_title text_999 f_30 bg_white mb_20"},[i("div",{staticClass:"mark_cell "},[i("span",[e._v("运输线路")]),i("div",[e._v(e._s(e.info.shipMentLineName))])]),i("div",{staticClass:"mark_cell "},[i("span",[e._v("车牌号")]),i("div",[e._v(e._s(e.info.vehicleNo))])]),i("div",{staticClass:"mark_cell "},[i("span",[e._v("规定发车时间")]),i("div",[e._v(e._s(e.info.planDepartureTime))])])]),i("div",{staticClass:"addmark_title text_333 f_30 bg_white mb_20"},[i("div",{staticClass:"mark_cell",on:{click:e.openType}},[i("span",[e._v("备案类型")]),i("div",{staticClass:"mr_20"},[e._v(e._s(e.checkedType?e.checkedType.text:"请选择"))]),i("van-icon",{attrs:{color:"#999999",name:"arrow"}})],1)]),i("div",{staticClass:"full_box bg_white"},[i("p",{staticClass:"text_333 f_30 mb_20"},[e._v("备案说明")]),i("div",{staticClass:"clearfix",on:{click:e.focus_input}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],ref:"elInput",staticClass:"f_30 mb_16",attrs:{placeholder:"请输入备案原因"},domProps:{value:e.description},on:{blur:e.pageHeight,input:function(t){t.target.composing||(e.description=t.target.value)}}}),i("p",{staticClass:"f_24 text_999 text_r"},[e._v(e._s(e.wordsize)+"/"+e._s(e.maxinfosize))])]),i("div",{staticClass:"upload_box"},[e._l(e.wxcheckedImg,function(t,a){return i("dl",{key:a},[i("img",{attrs:{src:t,alt:""},on:{click:function(t){return e.getPicforshow(a)}}}),i("div",{staticClass:"close",on:{click:function(t){return e.delImg(a)}}},[i("img",{attrs:{src:s("f1e9"),alt:""}})])])}),i("dl",{staticClass:"upload_btn needsclick",on:{click:e.getcameraForpic}},[i("dt"),i("dd",[e._v(e._s(e.picStreamList.length)+"/"+e._s(e.maxpic))])])],2)]),i("div",{staticClass:"footer_btn_box bg_white"},[i("button",{staticClass:"btn_submit submit_btn_active",on:{click:e.addRecordsInfo}},[e._v("提交")])])]),i("van-actionsheet",{attrs:{title:"请选择备案类型"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("van-picker",{attrs:{columns:e.type},on:{change:e.onChange}})],1)],1)},a=[],n=(s("a481"),s("28a5"),s("fc13")),o={mixins:[n["a"]],data:function(){return{description:"",licensePlate:"",maxinfosize:50,maxpic:3,info:null,type:[],checkedType:null,show:!1,wxcheckedImg:[],picStreamList:[],test:null,issubmiting:!1}},created:function(){this.info=this.$route.params,this.getType()},mounted:function(){this.getWxconfig()},computed:{wordsize:function(){var e=0;return this.description.length&&(e=this.description.length),this.description.length>this.maxinfosize?(this.description=this.description.substring(0,this.maxinfosize),this.maxinfosize):e}},methods:{pageHeight:function(){setTimeout(function(){var e=document.documentElement.scrollTop||document.body.scrollTop||0;window.scrollTo(0,Math.max(e-1,0))},100)},focus_input:function(){this.$refs.elInput.focus()},openType:function(){this.checkedType||(this.checkedType=this.type[0]),this.show=!0},addRecordsInfo:function(){var e=this;this.checkedType?this.issubmiting?this.$Tools.sendMessage("请勿重新提交!"):(this.issubmiting=!0,this.$store.dispatch("addTransportRecord",{openId:this.openId,transportOrder:this.info.shipMentNo,transportLine:this.info.shipMentLineName,licensePlate:this.info.vehicleNo,departureTime:this.info.planDepartureTime,secondCategoryId:this.checkedType.id,description:this.description,picStreamList:this.picStreamList}).then(function(t){e.issubmiting=!1,"000"==t.respCode?(e.$Tools.sendMessage(t.resMessage),e.$router.push({name:"home"})):e.$Tools.sendMessage(t.resMessage)})):this.$Tools.sendMessage("请您选择备案类型！")},getWxconfig:function(){var e=this;this.$store.dispatch("getJdk",{pageUrl:window.location.href.split("#")[0],openId:e.openId}).then(function(t){wx.config({debug:!1,appId:t.data.appId,timestamp:t.data.timestamp,nonceStr:t.data.noncestr,signature:t.data.signature,jsApiList:["getLocation","openLocation","chooseImage","uploadImage","getLocalImgData","previewImage"]}),wx.error(function(t){e.$Tools.sendMessage("微信JDK配置有误！"+t.errMsg)})})},getcameraForpic:function(){var e=this;e.picStreamList.length>=e.maxpic?e.$Tools.sendMessage("最多可传".concat(e.maxpic,"张图片！")):wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(t){var s=t.localIds;e.getBaseImg(s)}})},getBaseImg:function(e){for(var t=this,s=0;s<e.length;s++)t.wxcheckedImg.push(e[s]),wx.getLocalImgData({localId:e[s],success:function(e){var s;s=window.__wxjs_is_wkwebview?e.localData.replace("jpg","jpeg"):"data:image/jpeg;base64,"+e.localData,s=t.codeForBase64(s),t.picStreamList.push(s)}})},uploadImgTowx:function(e){wx.uploadImage({localId:e,isShowProgressTips:1,success:function(e){e.serverId}})},downLoadImg:function(){wx.downloadImage({serverId:"",isShowProgressTips:1,success:function(e){e.localId}})},codeForBase64:function(e){var t=e.split(",")[1];return t},getPicforshow:function(e){var t=this;wx.previewImage({current:t.wxcheckedImg[e],urls:t.wxcheckedImg})},getType:function(){var e=this;this.$store.dispatch("searchRecordType",{openId:this.openId}).then(function(t){e.type=e.pickerFormatter(t.data)})},pickerFormatter:function(e){var t=[];if(e)for(var s=0;s<e.length;s++)t.push({text:e[s].categoryName,id:e[s].id});return t},onChange:function(e,t,s){this.checkedType=t},delImg:function(e){this.picStreamList&&this.picStreamList.length>0&&(this.picStreamList.splice(e,1),this.wxcheckedImg.splice(e,1))}}},c=o,r=(s("eeb8"),s("2877")),d=Object(r["a"])(c,i,a,!1,null,null,null);t["default"]=d.exports},e536:function(e,t,s){},eeb8:function(e,t,s){"use strict";var i=s("e536"),a=s.n(i);a.a},f1e9:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAgRJREFUaAXtmL1OAkEUhUX+EXwfeCItxAQLKKChgAZJsPAFbCwsNNFEE0000WfSDr9bYE42wd0BloXk3uSEOzP3j5PdmTt7cODiDDgDzoAz4Aw4A86AM5CYgfl83gAnoJnYKcaQWC1wChoxpusvk2QKFnK2bkQCtRfB+J2GxjsMdcD+R3yuSNqRcZCK7wUOM3H6Fj0dlaTH4AuodEOz4dzTAOifIP1HyAolUR18AJV+0j+B00Ad0d/BUVL/jdiRsAbegMowLjjGQ3VAfwW1OL9U1klcBS9AZbwsGUZjNUR/BpVl9luZp4AyeAIqk2hyFidqgP4IylG7TMYUUgIPQOVvd2Fypgvo96CUSbHLklJQEdwBlWsGBhWzKS6Lk+k8hRXArVYb0W2tkGmRcckpMA9uIoXb0Obycf6h66ucxKE59scehvf3EaL4/X2JKd62UdsaVf7bRm3L3Y1tlELsILNDSSXJQWaHX7YHGQVUgLUDKiGthLUh1UzechJbM2eNmMoqzZw1hNtt5kho7bS1wCqDpEzi1FdHdGvN60n917Ijkd2J7fKh0gsNinNXA6DbJSn9Cw1JRpHEdi1cSYjTicQahQZa5STW/v08l8tdhiZd2ONrl/j2YsyvxpbpDaowZo+QfQJpbSossZrAPtWk/whtqmiP4ww4A86AM+AMOAPOwA4w8Au6ykuhMF8uVgAAAABJRU5ErkJggg=="},fc13:function(e,t,s){"use strict";s.d(t,"a",function(){return i});s("28a5");var i={data:function(){return{openId:null,phone:null,nodata:!1}},created:function(){this.$store.state.openId?this.openId=this.$store.state.openId:this.$Tools.sendMessage("获取openid失败！"),this.$store.state.phone?this.phone=this.$store.state.phone:window.location.href=this.$Wechat.redirectUrlPage("/user.html")},filters:{checkeState:function(e){var t="";switch(e){case"-1":t="暂不审核";break;case"-2":t="待复核";break;case"0":t="待审核";break;case"1":t="审核";break;case"2":t="打回网点";break;case"3":t="打回上一步";break;case"4":t="转发";break;case"5":t="审核完成";break;case"6":t="复核";break;case null:t="暂无";break}return t},checkedFormatterFormarklist:function(e){var t="";switch(e){case"0":t="全部";break;case"1":t="已提交";break;case"2":t="审核中";break;case"3":t="已打回";break;case"4":t="审核完成";break;case"5":t="作废";break}return t},formatterType:function(e){var t="";switch(e){case"0":t="发";break;case"1":t="到";break;default:t="其他";break}return t},formatterForinit:function(e){var t="";switch(e){case 0:t="发";break;case 1:t="到";break;default:t="其他";break}return t},dataFormatter:function(e){var t=e.split(" "),s=t[0].split("-");return s[1]+"月"+s[2]+"日"}},methods:{checkedInfo:function(){this.openId?(this.phone||(window.location.href=this.$Functions.getAllUrl("/user.html")),this.wxjdk||this.$Tools.sendMessage("获取微信JDK配置信息失败!")):this.$Tools.sendMessage("openId获取失败,请您重新打开页面获取openid！")}}}}}]);